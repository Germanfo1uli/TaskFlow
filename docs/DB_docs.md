# Документация по базе данных
- **Проект:** `JiraCopy` (Исправить)  
- **СУБД:** `PostgreSQL`
- **Версия:** `1.0.1`
- **Ответственный за документацию:** `Кривенышев Евгений (Ziragon)`
- **ERD-диаграмма:** `SUPERServer.drawio (модули: Users, Board, Issues, Deadlines, Dashboard, Notifications)`


## Серверная часть (Backend)

#### Язык и фреймворк:
1. **Java с Spring Boot**
2. **.NET C#**
- (Выбор будет зависеть от назначенного разработчика)

#### Архитектура: Микросервисная
**Каждый модуль (Users, Board, Issues, Deadlines, Dashboard, Notifications) — отдельный сервис**


## Нуждается в реализации или доработке:
1. **Доработка альтернативной авторизации (Google/GitHub)**
2. **Отсутствуют таблицы для файлов/вложений.**
3. **Кастомные статусы и теги для каждого проекта.**
4. **Отсутствуют типы задач (Bug, task, story, epic).**


## Общая информация о модулях БД
#### (Каждый модуль соответствует блоку в .drawio. Связи визуализированы стрелками)
#### (В скобках указано название соответствующего блока в файле .drawio)

- **Модуль пользователей (Users) — Аутентификация, профили, аватары, токены.**
- **Модуль проектов (Board) — Проекты, участники, роли, права доступа.**
- **Модуль задач (Issues) — Задачи, назначение, комментарии, иерархия.**
- **Модуль спринтов (Deadlines) — Спринты, привязка задач.**
- **Модуль аналитики (Dashboard) — Снапшоты, логи действий, метрики.**
- **Модуль уведомлений (Notifications) — Генерация, доставка, предпочтения.**


# Подробное описание модулей БД
## 1. Модуль пользователей (Users) (WIP, OAuth):
#### Назначение: Полный цикл работы с аккаунтами: регистрация (email/password + OAuth), аутентификация (JWT), управление сессиями (refresh-токены), профили и аватары.

#### Сущности и краткая информация: 
- **Users — Основная информация о пользователе (для аутентификации).**
- **UserProfiles — Дополнительные данные профиля (имя, био, настройки).**
- **Avatars — Метаданные файла аватара (URL, тип, размер).**
- **Tokens — Refresh-токены для сессий.**

- #### Связи (В скобках указывается тип связи и зависимое поле из 1 сущности):
- **UserProfiles -> Users (1:1 - User_Id)**
- **Users -> Avatars (1:1 - Avatar_Id)**
- **Token -> Users (N:1 - User_Id)**


## 2. Модуль проектов (Board):
#### Назначение: Управление проектами (создание, архивация), участниками, кастомными ролями и детализированными правами для каждой роли.

#### Сущности:
- **Projects — Основная информация о проекте (название, владелец, статус).**
- **ProjectMembers: Участники проекта и их роли.**
- **ProjectRoles — Роли в рамках конкретного проекта.**
- **RolePermissions — Назначенные права для роли.**
- **ProjectPermissions — Доступные права в проекте (шаблоны).**

#### Связи:
- **Projects -> Users (N:1 - Owner_Id)**
- **ProjectMembers -> Users (1:1 - User_Id)**
- **ProjectMembers -> Projects (1:1 - Project_Id)**
- **ProjectRoles -> Projects (N:1 - Project_Id)**
- **RolePermissions -> ProjectRoles (N:1 - Role_Id)**
- **RolePermissions -> ProjectPermissions (N:1 - Permission_Id)**


## 3. Модуль задач (Issues):
#### Назначение: Полный жизненный цикл задач: создание, назначение, комментарии, вложения, иерархия (задачи -> подзадачи).

#### Сущности:
- **Issues — Основная информация о задаче (название, описание, статус, приоритет).**
- **IssueAssignees — Назначенные исполнители.**
- **IssueComments — Комментарии к задаче (с возможностью прикрепления файлов).**

#### Связи:
- **Issues -> Projects (N:1 - Project_Id)**
- **Issues -> Issues (N:1 - Parent_Issue_Id)**
- **Issues -> Users (N:1 - Creator_Id)**
- **IssueAssignees -> Issues (N:1 - Issue_Id)**
- **IssueAssignees -> Users (N:1 - User_Id)**
- **IssueAssignees -> Users (N:1 - Assigner_Id)**
- **IssueComments -> Issues (N:1 - Issue_Id)**
- **IssueComments -> Users (N:1 - User_Id)**


## 4. Модуль спринтов (Deadlines):
#### Назначение: Планирование спринтов, привязка задач, отслеживание прогресса.

#### Сущности:
- **Sprints — Информация о спринте (название, даты начала/окончания, цель).**
- **SprintIssues — Задачи в спринте (связующая таблица).**

#### Зависимости:
- **Sprints -> Projects (N:1 - Project_Id)**
- **DeadlinedIssues -> Issues (N:1 - Issue_Id)**
- **DeadlinedIssues -> Sprints (N:1 - Sprint_Id)**


## 5. Модуль аналитики (Dashboard) (WIP):
#### Логирование событий, снапшоты метрик, дашборд-аналитика.

#### Сущности:
- **Dashboard_Snapshots — Снапшоты состояния проекта.**
- **ActivityLogs — Логи действий (события из системы прав).**

#### Зависимости:
- **Dashboard_Snapshots -> Projects (N:1 - Project_Id)**
- **ActivityLogs -> Projects (N:1 - Project_Id)**
- **ActivityLogs -> Users (N:1 - User_Id)**


## 6. Модуль уведомлений (Notifications) (WIP):
#### Генерация push/email/in-app уведомлений по событиям, управление подписками.

#### Сущности:
- **Notifications — Уведомления (генерируются при событиях).**
- **UserPreferences — Настройки уведомлений по типам событий.**

#### Зависимости:
- **Notifications -> Users (N:1 - User_Id)**
- **UserPreferences -> Users (N:1 - User_Id)**